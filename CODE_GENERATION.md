# Code Generation Setup

This document explains how to use code generation with Riverpod, Freezed, and JSON serialization.

## Dependencies

The following code generation dependencies are configured:
- `build_runner` - Code generation runner
- `riverpod_generator` - Generates Riverpod providers
- `freezed` - Generates immutable classes
- `json_serializable` - Generates JSON serialization code

## Known Issue: build_runner Compatibility

**Current Status:** There is a known compatibility issue between `analyzer_plugin 0.12.0` and `analyzer 7.6.0` that prevents `build_runner` from compiling.

**Workaround:** This will be resolved in future stories when we create actual providers. For now, the dependencies are configured correctly and ready to use.

**Tracking:** This issue will be addressed in Story 1.4 or when first creating providers in Epic 2.

## Usage Examples

### Riverpod Provider with Code Generation

```dart
import 'package:riverpod_annotation/riverpod_annotation.dart';

part 'my_provider.g.dart';

@riverpod
String appName(AppNameRef ref) {
  return 'Voice Phishing Prevention';
}

@riverpod
Future<int> fetchData(FetchDataRef ref) async {
  // Async logic here
  return 42;
}
```

### Freezed Immutable Class

```dart
import 'package:freezed_annotation/freezed_annotation.dart';

part 'call_info.freezed.dart';
part 'call_info.g.dart';

@freezed
class CallInfo with _$CallInfo {
  const factory CallInfo({
    required String phoneNumber,
    required DateTime timestamp,
    required CallState state,
  }) = _CallInfo;

  factory CallInfo.fromJson(Map<String, dynamic> json) =>
      _$CallInfoFromJson(json);
}
```

### Running Code Generation

```bash
# Generate code once
dart run build_runner build --delete-conflicting-outputs

# Watch for changes and regenerate
dart run build_runner watch --delete-conflicting-outputs

# Clean generated files
dart run build_runner clean
```

## Generated Files

Code generation creates the following file types:
- `*.g.dart` - Generated by riverpod_generator and json_serializable
- `*.freezed.dart` - Generated by freezed

These files are excluded from analysis in `analysis_options.yaml`.

## Best Practices

1. **Always use `part` directive** for generated files
2. **Run build_runner** after creating annotated classes
3. **Commit generated files** to git (recommended for team consistency)
4. **Use `--delete-conflicting-outputs`** to avoid conflicts
5. **Keep annotations up to date** with latest package versions
